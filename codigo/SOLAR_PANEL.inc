;-------------------------------------------------------------------------

							SOLAR_PANEL.inc

;-------------------------------------------------------------------------

READ_V_SOLAR_PANEL:
;RECIBE: NADA
;DEVUELVE: TENSION DEL PANEL EN ADC_DATA_H
	LDI ADC_DATA_L,ADC_SOLAR_PANEL			;ELIJO EL PIN DEL PANEL SOLAR
	RCALL ADC_SELECT_INPUT					;LLAMO LA FUNCION PARA SELECCIONAR EL PANEL SOLAR
	RCALL ADC_SIMPLE_CONVERSION				;LLAMO LA FUNCION PARA MEDIR
RET

CHECK_IF_SOLAR_PANEL_MINIMUM:
;RECIBE: TENSION DEL PANEL EN ADC_DATA_H
;DEVUELVE: [CARRY=1]: SOLAR_PANEL LOW. [CARRY=0]: SOLAR_PANEL OK
	CLC
	CPI		ADC_DATA_H,MIN_SOLAR_PANEL_VALUE	;COMPARAR PARA VER SI ES DE DIA O NOCHE
	BRCS	LOW_SOLAR_PANEL						;[CARRY=1]: SOLAR_PANEL LOW. [CARRY=0]: SOLAR_PANEL OK
	RET

INDICATE_SOLAR_PANEL_LOW:
;PRENDER EL PIN DEL PANEL BAJA
;APAGAR EL PIN DEL PANEL OK
	SEC										;[CARRY=1]: SOLAR_PANEL LOW. [CARRY=0]: SOLAR_PANEL OK
RET

ORIENTATE_SOLAR_PANEL:
	RCALL	READ_LDR
RET